{"ast":null,"code":"var Spaces = require('../../options/format').Spaces;\n\nvar Marker = require('../../tokenizer/marker');\n\nvar formatPosition = require('../../utils/format-position');\n\nvar CASE_ATTRIBUTE_PATTERN = /[\\s\"'][iI]\\s*\\]/;\nvar CASE_RESTORE_PATTERN = /([\\d\\w])([iI])\\]/g;\nvar DOUBLE_QUOTE_CASE_PATTERN = /=\"([a-zA-Z][a-zA-Z\\d\\-_]+)\"([iI])/g;\nvar DOUBLE_QUOTE_PATTERN = /=\"([a-zA-Z][a-zA-Z\\d\\-_]+)\"(\\s|\\])/g;\nvar HTML_COMMENT_PATTERN = /^(?:(?:<!--|-->)\\s*)+/;\nvar SINGLE_QUOTE_CASE_PATTERN = /='([a-zA-Z][a-zA-Z\\d\\-_]+)'([iI])/g;\nvar SINGLE_QUOTE_PATTERN = /='([a-zA-Z][a-zA-Z\\d\\-_]+)'(\\s|\\])/g;\nvar RELATION_PATTERN = /[>\\+~]/;\nvar WHITESPACE_PATTERN = /\\s/;\nvar ASTERISK_PLUS_HTML_HACK = '*+html ';\nvar ASTERISK_FIRST_CHILD_PLUS_HTML_HACK = '*:first-child+html ';\nvar LESS_THAN = '<';\nvar PSEUDO_CLASSES_WITH_SELECTORS = [':current', ':future', ':has', ':host', ':host-context', ':is', ':not', ':past', ':where'];\n\nfunction hasInvalidCharacters(value) {\n  var isEscaped;\n  var isInvalid = false;\n  var character;\n  var isQuote = false;\n  var i, l;\n\n  for (i = 0, l = value.length; i < l; i++) {\n    character = value[i];\n\n    if (isEscaped) {// continue as always\n    } else if (character == Marker.SINGLE_QUOTE || character == Marker.DOUBLE_QUOTE) {\n      isQuote = !isQuote;\n    } else if (!isQuote && (character == Marker.CLOSE_CURLY_BRACKET || character == Marker.EXCLAMATION || character == LESS_THAN || character == Marker.SEMICOLON)) {\n      isInvalid = true;\n      break;\n    } else if (!isQuote && i === 0 && RELATION_PATTERN.test(character)) {\n      isInvalid = true;\n      break;\n    }\n\n    isEscaped = character == Marker.BACK_SLASH;\n  }\n\n  return isInvalid;\n}\n\nfunction removeWhitespace(value, format) {\n  var stripped = [];\n  var character;\n  var isNewLineNix;\n  var isNewLineWin;\n  var isEscaped;\n  var wasEscaped;\n  var isQuoted;\n  var isSingleQuoted;\n  var isDoubleQuoted;\n  var isAttribute;\n  var isRelation;\n  var isWhitespace;\n  var isSpaceAwarePseudoClass;\n  var roundBracketLevel = 0;\n  var wasComma = false;\n  var wasRelation = false;\n  var wasWhitespace = false;\n  var withCaseAttribute = CASE_ATTRIBUTE_PATTERN.test(value);\n  var spaceAroundRelation = format && format.spaces[Spaces.AroundSelectorRelation];\n  var i, l;\n\n  for (i = 0, l = value.length; i < l; i++) {\n    character = value[i];\n    isNewLineNix = character == Marker.NEW_LINE_NIX;\n    isNewLineWin = character == Marker.NEW_LINE_NIX && value[i - 1] == Marker.CARRIAGE_RETURN;\n    isQuoted = isSingleQuoted || isDoubleQuoted;\n    isRelation = !isAttribute && !isEscaped && roundBracketLevel === 0 && RELATION_PATTERN.test(character);\n    isWhitespace = WHITESPACE_PATTERN.test(character);\n    isSpaceAwarePseudoClass = roundBracketLevel == 1 && character == Marker.CLOSE_ROUND_BRACKET ? false : isSpaceAwarePseudoClass || roundBracketLevel === 0 && character == Marker.COLON && isPseudoClassWithSelectors(value, i);\n\n    if (wasEscaped && isQuoted && isNewLineWin) {\n      // swallow escaped new windows lines in comments\n      stripped.pop();\n      stripped.pop();\n    } else if (isEscaped && isQuoted && isNewLineNix) {\n      // swallow escaped new *nix lines in comments\n      stripped.pop();\n    } else if (isEscaped) {\n      stripped.push(character);\n    } else if (character == Marker.OPEN_SQUARE_BRACKET && !isQuoted) {\n      stripped.push(character);\n      isAttribute = true;\n    } else if (character == Marker.CLOSE_SQUARE_BRACKET && !isQuoted) {\n      stripped.push(character);\n      isAttribute = false;\n    } else if (character == Marker.OPEN_ROUND_BRACKET && !isQuoted) {\n      stripped.push(character);\n      roundBracketLevel++;\n    } else if (character == Marker.CLOSE_ROUND_BRACKET && !isQuoted) {\n      stripped.push(character);\n      roundBracketLevel--;\n    } else if (character == Marker.SINGLE_QUOTE && !isQuoted) {\n      stripped.push(character);\n      isSingleQuoted = true;\n    } else if (character == Marker.DOUBLE_QUOTE && !isQuoted) {\n      stripped.push(character);\n      isDoubleQuoted = true;\n    } else if (character == Marker.SINGLE_QUOTE && isQuoted) {\n      stripped.push(character);\n      isSingleQuoted = false;\n    } else if (character == Marker.DOUBLE_QUOTE && isQuoted) {\n      stripped.push(character);\n      isDoubleQuoted = false;\n    } else if (isWhitespace && wasRelation && !spaceAroundRelation) {\n      continue;\n    } else if (!isWhitespace && wasRelation && spaceAroundRelation) {\n      stripped.push(Marker.SPACE);\n      stripped.push(character);\n    } else if (isWhitespace && !wasWhitespace && wasComma && roundBracketLevel > 0 && isSpaceAwarePseudoClass) {// skip space\n    } else if (isWhitespace && !wasWhitespace && roundBracketLevel > 0 && isSpaceAwarePseudoClass) {\n      stripped.push(character);\n    } else if (isWhitespace && (isAttribute || roundBracketLevel > 0) && !isQuoted) {// skip space\n    } else if (isWhitespace && wasWhitespace && !isQuoted) {// skip extra space\n    } else if ((isNewLineWin || isNewLineNix) && (isAttribute || roundBracketLevel > 0) && isQuoted) {// skip newline\n    } else if (isRelation && wasWhitespace && !spaceAroundRelation) {\n      stripped.pop();\n      stripped.push(character);\n    } else if (isRelation && !wasWhitespace && spaceAroundRelation) {\n      stripped.push(Marker.SPACE);\n      stripped.push(character);\n    } else if (isWhitespace) {\n      stripped.push(Marker.SPACE);\n    } else {\n      stripped.push(character);\n    }\n\n    wasEscaped = isEscaped;\n    isEscaped = character == Marker.BACK_SLASH;\n    wasRelation = isRelation;\n    wasWhitespace = isWhitespace;\n    wasComma = character == Marker.COMMA;\n  }\n\n  return withCaseAttribute ? stripped.join('').replace(CASE_RESTORE_PATTERN, '$1 $2]') : stripped.join('');\n}\n\nfunction isPseudoClassWithSelectors(value, colonPosition) {\n  var pseudoClass = value.substring(colonPosition, value.indexOf(Marker.OPEN_ROUND_BRACKET, colonPosition));\n  return PSEUDO_CLASSES_WITH_SELECTORS.indexOf(pseudoClass) > -1;\n}\n\nfunction removeQuotes(value) {\n  if (value.indexOf('\\'') == -1 && value.indexOf('\"') == -1) {\n    return value;\n  }\n\n  return value.replace(SINGLE_QUOTE_CASE_PATTERN, '=$1 $2').replace(SINGLE_QUOTE_PATTERN, '=$1$2').replace(DOUBLE_QUOTE_CASE_PATTERN, '=$1 $2').replace(DOUBLE_QUOTE_PATTERN, '=$1$2');\n}\n\nfunction tidyRules(rules, removeUnsupported, adjacentSpace, format, warnings) {\n  var list = [];\n  var repeated = [];\n\n  function removeHTMLComment(rule, match) {\n    warnings.push('HTML comment \\'' + match + '\\' at ' + formatPosition(rule[2][0]) + '. Removing.');\n    return '';\n  }\n\n  for (var i = 0, l = rules.length; i < l; i++) {\n    var rule = rules[i];\n    var reduced = rule[1];\n    reduced = reduced.replace(HTML_COMMENT_PATTERN, removeHTMLComment.bind(null, rule));\n\n    if (hasInvalidCharacters(reduced)) {\n      warnings.push('Invalid selector \\'' + rule[1] + '\\' at ' + formatPosition(rule[2][0]) + '. Ignoring.');\n      continue;\n    }\n\n    reduced = removeWhitespace(reduced, format);\n    reduced = removeQuotes(reduced);\n\n    if (adjacentSpace && reduced.indexOf('nav') > 0) {\n      reduced = reduced.replace(/\\+nav(\\S|$)/, '+ nav$1');\n    }\n\n    if (removeUnsupported && reduced.indexOf(ASTERISK_PLUS_HTML_HACK) > -1) {\n      continue;\n    }\n\n    if (removeUnsupported && reduced.indexOf(ASTERISK_FIRST_CHILD_PLUS_HTML_HACK) > -1) {\n      continue;\n    }\n\n    if (reduced.indexOf('*') > -1) {\n      reduced = reduced.replace(/\\*([:#\\.\\[])/g, '$1').replace(/^(\\:first\\-child)?\\+html/, '*$1+html');\n    }\n\n    if (repeated.indexOf(reduced) > -1) {\n      continue;\n    }\n\n    rule[1] = reduced;\n    repeated.push(reduced);\n    list.push(rule);\n  }\n\n  if (list.length == 1 && list[0][1].length === 0) {\n    warnings.push('Empty selector \\'' + list[0][1] + '\\' at ' + formatPosition(list[0][2][0]) + '. Ignoring.');\n    list = [];\n  }\n\n  return list;\n}\n\nmodule.exports = tidyRules;","map":{"version":3,"sources":["/home/hp/Js/React_practise/BookStore/books/node_modules/clean-css/lib/optimizer/level-1/tidy-rules.js"],"names":["Spaces","require","Marker","formatPosition","CASE_ATTRIBUTE_PATTERN","CASE_RESTORE_PATTERN","DOUBLE_QUOTE_CASE_PATTERN","DOUBLE_QUOTE_PATTERN","HTML_COMMENT_PATTERN","SINGLE_QUOTE_CASE_PATTERN","SINGLE_QUOTE_PATTERN","RELATION_PATTERN","WHITESPACE_PATTERN","ASTERISK_PLUS_HTML_HACK","ASTERISK_FIRST_CHILD_PLUS_HTML_HACK","LESS_THAN","PSEUDO_CLASSES_WITH_SELECTORS","hasInvalidCharacters","value","isEscaped","isInvalid","character","isQuote","i","l","length","SINGLE_QUOTE","DOUBLE_QUOTE","CLOSE_CURLY_BRACKET","EXCLAMATION","SEMICOLON","test","BACK_SLASH","removeWhitespace","format","stripped","isNewLineNix","isNewLineWin","wasEscaped","isQuoted","isSingleQuoted","isDoubleQuoted","isAttribute","isRelation","isWhitespace","isSpaceAwarePseudoClass","roundBracketLevel","wasComma","wasRelation","wasWhitespace","withCaseAttribute","spaceAroundRelation","spaces","AroundSelectorRelation","NEW_LINE_NIX","CARRIAGE_RETURN","CLOSE_ROUND_BRACKET","COLON","isPseudoClassWithSelectors","pop","push","OPEN_SQUARE_BRACKET","CLOSE_SQUARE_BRACKET","OPEN_ROUND_BRACKET","SPACE","COMMA","join","replace","colonPosition","pseudoClass","substring","indexOf","removeQuotes","tidyRules","rules","removeUnsupported","adjacentSpace","warnings","list","repeated","removeHTMLComment","rule","match","reduced","bind","module","exports"],"mappings":"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","sourcesContent":["var Spaces = require('../../options/format').Spaces;\nvar Marker = require('../../tokenizer/marker');\nvar formatPosition = require('../../utils/format-position');\n\nvar CASE_ATTRIBUTE_PATTERN = /[\\s\"'][iI]\\s*\\]/;\nvar CASE_RESTORE_PATTERN = /([\\d\\w])([iI])\\]/g;\nvar DOUBLE_QUOTE_CASE_PATTERN = /=\"([a-zA-Z][a-zA-Z\\d\\-_]+)\"([iI])/g;\nvar DOUBLE_QUOTE_PATTERN = /=\"([a-zA-Z][a-zA-Z\\d\\-_]+)\"(\\s|\\])/g;\nvar HTML_COMMENT_PATTERN = /^(?:(?:<!--|-->)\\s*)+/;\nvar SINGLE_QUOTE_CASE_PATTERN = /='([a-zA-Z][a-zA-Z\\d\\-_]+)'([iI])/g;\nvar SINGLE_QUOTE_PATTERN = /='([a-zA-Z][a-zA-Z\\d\\-_]+)'(\\s|\\])/g;\nvar RELATION_PATTERN = /[>\\+~]/;\nvar WHITESPACE_PATTERN = /\\s/;\n\nvar ASTERISK_PLUS_HTML_HACK = '*+html ';\nvar ASTERISK_FIRST_CHILD_PLUS_HTML_HACK = '*:first-child+html ';\nvar LESS_THAN = '<';\n\nvar PSEUDO_CLASSES_WITH_SELECTORS = [\n  ':current',\n  ':future',\n  ':has',\n  ':host',\n  ':host-context',\n  ':is',\n  ':not',\n  ':past',\n  ':where'\n];\n\nfunction hasInvalidCharacters(value) {\n  var isEscaped;\n  var isInvalid = false;\n  var character;\n  var isQuote = false;\n  var i, l;\n\n  for (i = 0, l = value.length; i < l; i++) {\n    character = value[i];\n\n    if (isEscaped) {\n      // continue as always\n    } else if (character == Marker.SINGLE_QUOTE || character == Marker.DOUBLE_QUOTE) {\n      isQuote = !isQuote;\n    } else if (!isQuote && (character == Marker.CLOSE_CURLY_BRACKET || character == Marker.EXCLAMATION || character == LESS_THAN || character == Marker.SEMICOLON)) {\n      isInvalid = true;\n      break;\n    } else if (!isQuote && i === 0 && RELATION_PATTERN.test(character)) {\n      isInvalid = true;\n      break;\n    }\n\n    isEscaped = character == Marker.BACK_SLASH;\n  }\n\n  return isInvalid;\n}\n\nfunction removeWhitespace(value, format) {\n  var stripped = [];\n  var character;\n  var isNewLineNix;\n  var isNewLineWin;\n  var isEscaped;\n  var wasEscaped;\n  var isQuoted;\n  var isSingleQuoted;\n  var isDoubleQuoted;\n  var isAttribute;\n  var isRelation;\n  var isWhitespace;\n  var isSpaceAwarePseudoClass;\n  var roundBracketLevel = 0;\n  var wasComma = false;\n  var wasRelation = false;\n  var wasWhitespace = false;\n  var withCaseAttribute = CASE_ATTRIBUTE_PATTERN.test(value);\n  var spaceAroundRelation = format && format.spaces[Spaces.AroundSelectorRelation];\n  var i, l;\n\n  for (i = 0, l = value.length; i < l; i++) {\n    character = value[i];\n\n    isNewLineNix = character == Marker.NEW_LINE_NIX;\n    isNewLineWin = character == Marker.NEW_LINE_NIX && value[i - 1] == Marker.CARRIAGE_RETURN;\n    isQuoted = isSingleQuoted || isDoubleQuoted;\n    isRelation = !isAttribute && !isEscaped && roundBracketLevel === 0 && RELATION_PATTERN.test(character);\n    isWhitespace = WHITESPACE_PATTERN.test(character);\n    isSpaceAwarePseudoClass = roundBracketLevel == 1 && character == Marker.CLOSE_ROUND_BRACKET ?\n      false :\n      isSpaceAwarePseudoClass || (roundBracketLevel === 0 && character == Marker.COLON && isPseudoClassWithSelectors(value, i));\n\n    if (wasEscaped && isQuoted && isNewLineWin) {\n      // swallow escaped new windows lines in comments\n      stripped.pop();\n      stripped.pop();\n    } else if (isEscaped && isQuoted && isNewLineNix) {\n      // swallow escaped new *nix lines in comments\n      stripped.pop();\n    } else if (isEscaped) {\n      stripped.push(character);\n    } else if (character == Marker.OPEN_SQUARE_BRACKET && !isQuoted) {\n      stripped.push(character);\n      isAttribute = true;\n    } else if (character == Marker.CLOSE_SQUARE_BRACKET && !isQuoted) {\n      stripped.push(character);\n      isAttribute = false;\n    } else if (character == Marker.OPEN_ROUND_BRACKET && !isQuoted) {\n      stripped.push(character);\n      roundBracketLevel++;\n    } else if (character == Marker.CLOSE_ROUND_BRACKET && !isQuoted) {\n      stripped.push(character);\n      roundBracketLevel--;\n    } else if (character == Marker.SINGLE_QUOTE && !isQuoted) {\n      stripped.push(character);\n      isSingleQuoted = true;\n    } else if (character == Marker.DOUBLE_QUOTE && !isQuoted) {\n      stripped.push(character);\n      isDoubleQuoted = true;\n    } else if (character == Marker.SINGLE_QUOTE && isQuoted) {\n      stripped.push(character);\n      isSingleQuoted = false;\n    } else if (character == Marker.DOUBLE_QUOTE && isQuoted) {\n      stripped.push(character);\n      isDoubleQuoted = false;\n    } else if (isWhitespace && wasRelation && !spaceAroundRelation) {\n      continue;\n    } else if (!isWhitespace && wasRelation && spaceAroundRelation) {\n      stripped.push(Marker.SPACE);\n      stripped.push(character);\n    } else if (isWhitespace && !wasWhitespace && wasComma && roundBracketLevel > 0 && isSpaceAwarePseudoClass) {\n      // skip space\n    } else if (isWhitespace && !wasWhitespace && roundBracketLevel > 0 && isSpaceAwarePseudoClass) {\n      stripped.push(character);\n    } else if (isWhitespace && (isAttribute || roundBracketLevel > 0) && !isQuoted) {\n      // skip space\n    } else if (isWhitespace && wasWhitespace && !isQuoted) {\n      // skip extra space\n    } else if ((isNewLineWin || isNewLineNix) && (isAttribute || roundBracketLevel > 0) && isQuoted) {\n      // skip newline\n    } else if (isRelation && wasWhitespace && !spaceAroundRelation) {\n      stripped.pop();\n      stripped.push(character);\n    } else if (isRelation && !wasWhitespace && spaceAroundRelation) {\n      stripped.push(Marker.SPACE);\n      stripped.push(character);\n    } else if (isWhitespace) {\n      stripped.push(Marker.SPACE);\n    } else {\n      stripped.push(character);\n    }\n\n    wasEscaped = isEscaped;\n    isEscaped = character == Marker.BACK_SLASH;\n    wasRelation = isRelation;\n    wasWhitespace = isWhitespace;\n    wasComma = character == Marker.COMMA;\n  }\n\n  return withCaseAttribute ?\n    stripped.join('').replace(CASE_RESTORE_PATTERN, '$1 $2]') :\n    stripped.join('');\n}\n\nfunction isPseudoClassWithSelectors(value, colonPosition) {\n  var pseudoClass = value.substring(colonPosition, value.indexOf(Marker.OPEN_ROUND_BRACKET, colonPosition));\n\n  return PSEUDO_CLASSES_WITH_SELECTORS.indexOf(pseudoClass) > -1;\n}\n\nfunction removeQuotes(value) {\n  if (value.indexOf('\\'') == -1 && value.indexOf('\"') == -1) {\n    return value;\n  }\n\n  return value\n    .replace(SINGLE_QUOTE_CASE_PATTERN, '=$1 $2')\n    .replace(SINGLE_QUOTE_PATTERN, '=$1$2')\n    .replace(DOUBLE_QUOTE_CASE_PATTERN, '=$1 $2')\n    .replace(DOUBLE_QUOTE_PATTERN, '=$1$2');\n}\n\nfunction tidyRules(rules, removeUnsupported, adjacentSpace, format, warnings) {\n  var list = [];\n  var repeated = [];\n\n  function removeHTMLComment(rule, match) {\n    warnings.push('HTML comment \\'' + match + '\\' at ' + formatPosition(rule[2][0]) + '. Removing.');\n    return '';\n  }\n\n  for (var i = 0, l = rules.length; i < l; i++) {\n    var rule = rules[i];\n    var reduced = rule[1];\n\n    reduced = reduced.replace(HTML_COMMENT_PATTERN, removeHTMLComment.bind(null, rule));\n\n    if (hasInvalidCharacters(reduced)) {\n      warnings.push('Invalid selector \\'' + rule[1] + '\\' at ' + formatPosition(rule[2][0]) + '. Ignoring.');\n      continue;\n    }\n\n    reduced = removeWhitespace(reduced, format);\n    reduced = removeQuotes(reduced);\n\n    if (adjacentSpace && reduced.indexOf('nav') > 0) {\n      reduced = reduced.replace(/\\+nav(\\S|$)/, '+ nav$1');\n    }\n\n    if (removeUnsupported && reduced.indexOf(ASTERISK_PLUS_HTML_HACK) > -1) {\n      continue;\n    }\n\n    if (removeUnsupported && reduced.indexOf(ASTERISK_FIRST_CHILD_PLUS_HTML_HACK) > -1) {\n      continue;\n    }\n\n    if (reduced.indexOf('*') > -1) {\n      reduced = reduced\n        .replace(/\\*([:#\\.\\[])/g, '$1')\n        .replace(/^(\\:first\\-child)?\\+html/, '*$1+html');\n    }\n\n    if (repeated.indexOf(reduced) > -1) {\n      continue;\n    }\n\n    rule[1] = reduced;\n    repeated.push(reduced);\n    list.push(rule);\n  }\n\n  if (list.length == 1 && list[0][1].length === 0) {\n    warnings.push('Empty selector \\'' + list[0][1] + '\\' at ' + formatPosition(list[0][2][0]) + '. Ignoring.');\n    list = [];\n  }\n\n  return list;\n}\n\nmodule.exports = tidyRules;\n"]},"metadata":{},"sourceType":"script"}