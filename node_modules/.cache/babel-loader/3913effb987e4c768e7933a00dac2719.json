{"ast":null,"code":"var sortSelectors = require('./sort-selectors');\n\nvar tidyRules = require('./tidy-rules');\n\nvar tidyBlock = require('./tidy-block');\n\nvar tidyAtRule = require('./tidy-at-rule');\n\nvar Hack = require('../hack');\n\nvar removeUnused = require('../remove-unused');\n\nvar restoreFromOptimizing = require('../restore-from-optimizing');\n\nvar wrapForOptimizing = require('../wrap-for-optimizing').all;\n\nvar configuration = require('../configuration');\n\nvar optimizers = require('./value-optimizers');\n\nvar OptimizationLevel = require('../../options/optimization-level').OptimizationLevel;\n\nvar Token = require('../../tokenizer/token');\n\nvar Marker = require('../../tokenizer/marker');\n\nvar formatPosition = require('../../utils/format-position');\n\nvar serializeRules = require('../../writer/one-time').rules;\n\nvar CHARSET_TOKEN = '@charset';\nvar CHARSET_REGEXP = new RegExp('^' + CHARSET_TOKEN, 'i');\n\nvar DEFAULT_ROUNDING_PRECISION = require('../../options/rounding-precision').DEFAULT;\n\nvar PROPERTY_NAME_PATTERN = /^(?:\\-chrome\\-|\\-[\\w\\-]+\\w|\\w[\\w\\-]+\\w|\\w{1,}|\\-\\-\\S+)$/;\nvar IMPORT_PREFIX_PATTERN = /^@import/i;\nvar URL_PREFIX_PATTERN = /^url\\(/i;\n\nfunction startsAsUrl(value) {\n  return URL_PREFIX_PATTERN.test(value);\n}\n\nfunction isImport(token) {\n  return IMPORT_PREFIX_PATTERN.test(token[1]);\n}\n\nfunction isLegacyFilter(property) {\n  var value;\n\n  if (property.name == 'filter' || property.name == '-ms-filter') {\n    value = property.value[0][1];\n    return value.indexOf('progid') > -1 || value.indexOf('alpha') === 0 || value.indexOf('chroma') === 0;\n  } else {\n    return false;\n  }\n}\n\nfunction noop() {}\n\nfunction optimizeBody(rule, properties, context) {\n  var options = context.options;\n  var valueOptimizers;\n  var property, name, type, value;\n  var propertyToken;\n  var propertyOptimizer;\n  var serializedRule = serializeRules(rule);\n\n  var _properties = wrapForOptimizing(properties);\n\n  var pluginValueOptimizers = context.options.plugins.level1Value;\n  var pluginPropertyOptimizers = context.options.plugins.level1Property;\n  var i, l;\n\n  propertyLoop: for (i = 0, l = _properties.length; i < l; i++) {\n    var j, k, m, n;\n    property = _properties[i];\n    name = property.name;\n    propertyOptimizer = configuration[name] && configuration[name].propertyOptimizer || noop;\n    valueOptimizers = configuration[name] && configuration[name].valueOptimizers || [optimizers.whiteSpace];\n\n    if (!PROPERTY_NAME_PATTERN.test(name)) {\n      propertyToken = property.all[property.position];\n      context.warnings.push('Invalid property name \\'' + name + '\\' at ' + formatPosition(propertyToken[1][2][0]) + '. Ignoring.');\n      property.unused = true;\n      continue;\n    }\n\n    if (property.value.length === 0) {\n      propertyToken = property.all[property.position];\n      context.warnings.push('Empty property \\'' + name + '\\' at ' + formatPosition(propertyToken[1][2][0]) + '. Ignoring.');\n      property.unused = true;\n      continue;\n    }\n\n    if (property.hack && ((property.hack[0] == Hack.ASTERISK || property.hack[0] == Hack.UNDERSCORE) && !options.compatibility.properties.iePrefixHack || property.hack[0] == Hack.BACKSLASH && !options.compatibility.properties.ieSuffixHack || property.hack[0] == Hack.BANG && !options.compatibility.properties.ieBangHack)) {\n      property.unused = true;\n      continue;\n    }\n\n    if (!options.compatibility.properties.ieFilters && isLegacyFilter(property)) {\n      property.unused = true;\n      continue;\n    }\n\n    if (property.block) {\n      optimizeBody(rule, property.value[0][1], context);\n      continue;\n    }\n\n    valuesLoop: for (j = 0, m = property.value.length; j < m; j++) {\n      type = property.value[j][0];\n      value = property.value[j][1];\n\n      if (type == Token.PROPERTY_BLOCK) {\n        property.unused = true;\n        context.warnings.push('Invalid value token at ' + formatPosition(value[0][1][2][0]) + '. Ignoring.');\n        break;\n      }\n\n      if (startsAsUrl(value) && !context.validator.isUrl(value)) {\n        property.unused = true;\n        context.warnings.push('Broken URL \\'' + value + '\\' at ' + formatPosition(property.value[j][2][0]) + '. Ignoring.');\n        break;\n      }\n\n      for (k = 0, n = valueOptimizers.length; k < n; k++) {\n        value = valueOptimizers[k](name, value, options);\n      }\n\n      for (k = 0, n = pluginValueOptimizers.length; k < n; k++) {\n        value = pluginValueOptimizers[k](name, value, options);\n      }\n\n      property.value[j][1] = value;\n    }\n\n    propertyOptimizer(serializedRule, property, options);\n\n    for (j = 0, m = pluginPropertyOptimizers.length; j < m; j++) {\n      pluginPropertyOptimizers[j](serializedRule, property, options);\n    }\n  }\n\n  restoreFromOptimizing(_properties);\n  removeUnused(_properties);\n  removeComments(properties, options);\n}\n\nfunction removeComments(tokens, options) {\n  var token;\n  var i;\n\n  for (i = 0; i < tokens.length; i++) {\n    token = tokens[i];\n\n    if (token[0] != Token.COMMENT) {\n      continue;\n    }\n\n    optimizeComment(token, options);\n\n    if (token[1].length === 0) {\n      tokens.splice(i, 1);\n      i--;\n    }\n  }\n}\n\nfunction optimizeComment(token, options) {\n  if (token[1][2] == Marker.EXCLAMATION && (options.level[OptimizationLevel.One].specialComments == 'all' || options.commentsKept < options.level[OptimizationLevel.One].specialComments)) {\n    options.commentsKept++;\n    return;\n  }\n\n  token[1] = [];\n}\n\nfunction cleanupCharsets(tokens) {\n  var hasCharset = false;\n\n  for (var i = 0, l = tokens.length; i < l; i++) {\n    var token = tokens[i];\n    if (token[0] != Token.AT_RULE) continue;\n    if (!CHARSET_REGEXP.test(token[1])) continue;\n\n    if (hasCharset || token[1].indexOf(CHARSET_TOKEN) == -1) {\n      tokens.splice(i, 1);\n      i--;\n      l--;\n    } else {\n      hasCharset = true;\n      tokens.splice(i, 1);\n      tokens.unshift([Token.AT_RULE, token[1].replace(CHARSET_REGEXP, CHARSET_TOKEN)]);\n    }\n  }\n}\n\nfunction buildUnitRegexp(options) {\n  var units = ['px', 'em', 'ex', 'cm', 'mm', 'in', 'pt', 'pc', '%'];\n  var otherUnits = ['ch', 'rem', 'vh', 'vm', 'vmax', 'vmin', 'vw'];\n  otherUnits.forEach(function (unit) {\n    if (options.compatibility.units[unit]) {\n      units.push(unit);\n    }\n  });\n  return new RegExp('(^|\\\\s|\\\\(|,)0(?:' + units.join('|') + ')(\\\\W|$)', 'g');\n}\n\nfunction buildPrecisionOptions(roundingPrecision) {\n  var precisionOptions = {\n    matcher: null,\n    units: {}\n  };\n  var optimizable = [];\n  var unit;\n  var value;\n\n  for (unit in roundingPrecision) {\n    value = roundingPrecision[unit];\n\n    if (value != DEFAULT_ROUNDING_PRECISION) {\n      precisionOptions.units[unit] = {};\n      precisionOptions.units[unit].value = value;\n      precisionOptions.units[unit].multiplier = Math.pow(10, value);\n      optimizable.push(unit);\n    }\n  }\n\n  if (optimizable.length > 0) {\n    precisionOptions.enabled = true;\n    precisionOptions.decimalPointMatcher = new RegExp('(\\\\d)\\\\.($|' + optimizable.join('|') + ')($|\\\\W)', 'g');\n    precisionOptions.zeroMatcher = new RegExp('(\\\\d*)(\\\\.\\\\d+)(' + optimizable.join('|') + ')', 'g');\n  }\n\n  return precisionOptions;\n}\n\nfunction level1Optimize(tokens, context) {\n  var options = context.options;\n  var levelOptions = options.level[OptimizationLevel.One];\n  var ie7Hack = options.compatibility.selectors.ie7Hack;\n  var adjacentSpace = options.compatibility.selectors.adjacentSpace;\n  var spaceAfterClosingBrace = options.compatibility.properties.spaceAfterClosingBrace;\n  var format = options.format;\n  var mayHaveCharset = false;\n  var afterRules = false;\n  options.unitsRegexp = options.unitsRegexp || buildUnitRegexp(options);\n  options.precision = options.precision || buildPrecisionOptions(levelOptions.roundingPrecision);\n  options.commentsKept = options.commentsKept || 0;\n\n  for (var i = 0, l = tokens.length; i < l; i++) {\n    var token = tokens[i];\n\n    switch (token[0]) {\n      case Token.AT_RULE:\n        token[1] = isImport(token) && afterRules ? '' : token[1];\n        token[1] = levelOptions.tidyAtRules ? tidyAtRule(token[1]) : token[1];\n        mayHaveCharset = true;\n        break;\n\n      case Token.AT_RULE_BLOCK:\n        optimizeBody(token[1], token[2], context);\n        afterRules = true;\n        break;\n\n      case Token.NESTED_BLOCK:\n        token[1] = levelOptions.tidyBlockScopes ? tidyBlock(token[1], spaceAfterClosingBrace) : token[1];\n        level1Optimize(token[2], context);\n        afterRules = true;\n        break;\n\n      case Token.COMMENT:\n        optimizeComment(token, options);\n        break;\n\n      case Token.RULE:\n        token[1] = levelOptions.tidySelectors ? tidyRules(token[1], !ie7Hack, adjacentSpace, format, context.warnings) : token[1];\n        token[1] = token[1].length > 1 ? sortSelectors(token[1], levelOptions.selectorsSortingMethod) : token[1];\n        optimizeBody(token[1], token[2], context);\n        afterRules = true;\n        break;\n    }\n\n    if (token[0] == Token.COMMENT && token[1].length === 0 || levelOptions.removeEmpty && (token[1].length === 0 || token[2] && token[2].length === 0)) {\n      tokens.splice(i, 1);\n      i--;\n      l--;\n    }\n  }\n\n  if (levelOptions.cleanupCharsets && mayHaveCharset) {\n    cleanupCharsets(tokens);\n  }\n\n  return tokens;\n}\n\nmodule.exports = level1Optimize;","map":{"version":3,"sources":["/home/hp/Js/React_practise/BookStore/books/node_modules/clean-css/lib/optimizer/level-1/optimize.js"],"names":["sortSelectors","require","tidyRules","tidyBlock","tidyAtRule","Hack","removeUnused","restoreFromOptimizing","wrapForOptimizing","all","configuration","optimizers","OptimizationLevel","Token","Marker","formatPosition","serializeRules","rules","CHARSET_TOKEN","CHARSET_REGEXP","RegExp","DEFAULT_ROUNDING_PRECISION","DEFAULT","PROPERTY_NAME_PATTERN","IMPORT_PREFIX_PATTERN","URL_PREFIX_PATTERN","startsAsUrl","value","test","isImport","token","isLegacyFilter","property","name","indexOf","noop","optimizeBody","rule","properties","context","options","valueOptimizers","type","propertyToken","propertyOptimizer","serializedRule","_properties","pluginValueOptimizers","plugins","level1Value","pluginPropertyOptimizers","level1Property","i","l","propertyLoop","length","j","k","m","n","whiteSpace","position","warnings","push","unused","hack","ASTERISK","UNDERSCORE","compatibility","iePrefixHack","BACKSLASH","ieSuffixHack","BANG","ieBangHack","ieFilters","block","valuesLoop","PROPERTY_BLOCK","validator","isUrl","removeComments","tokens","COMMENT","optimizeComment","splice","EXCLAMATION","level","One","specialComments","commentsKept","cleanupCharsets","hasCharset","AT_RULE","unshift","replace","buildUnitRegexp","units","otherUnits","forEach","unit","join","buildPrecisionOptions","roundingPrecision","precisionOptions","matcher","optimizable","multiplier","Math","pow","enabled","decimalPointMatcher","zeroMatcher","level1Optimize","levelOptions","ie7Hack","selectors","adjacentSpace","spaceAfterClosingBrace","format","mayHaveCharset","afterRules","unitsRegexp","precision","tidyAtRules","AT_RULE_BLOCK","NESTED_BLOCK","tidyBlockScopes","RULE","tidySelectors","selectorsSortingMethod","removeEmpty","module","exports"],"mappings":"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","sourcesContent":["var sortSelectors = require('./sort-selectors');\nvar tidyRules = require('./tidy-rules');\nvar tidyBlock = require('./tidy-block');\nvar tidyAtRule = require('./tidy-at-rule');\n\nvar Hack = require('../hack');\nvar removeUnused = require('../remove-unused');\nvar restoreFromOptimizing = require('../restore-from-optimizing');\nvar wrapForOptimizing = require('../wrap-for-optimizing').all;\n\nvar configuration = require('../configuration');\nvar optimizers = require('./value-optimizers');\n\nvar OptimizationLevel = require('../../options/optimization-level').OptimizationLevel;\n\nvar Token = require('../../tokenizer/token');\nvar Marker = require('../../tokenizer/marker');\n\nvar formatPosition = require('../../utils/format-position');\n\nvar serializeRules = require('../../writer/one-time').rules;\n\nvar CHARSET_TOKEN = '@charset';\nvar CHARSET_REGEXP = new RegExp('^' + CHARSET_TOKEN, 'i');\n\nvar DEFAULT_ROUNDING_PRECISION = require('../../options/rounding-precision').DEFAULT;\n\nvar PROPERTY_NAME_PATTERN = /^(?:\\-chrome\\-|\\-[\\w\\-]+\\w|\\w[\\w\\-]+\\w|\\w{1,}|\\-\\-\\S+)$/;\nvar IMPORT_PREFIX_PATTERN = /^@import/i;\nvar URL_PREFIX_PATTERN = /^url\\(/i;\n\nfunction startsAsUrl(value) {\n  return URL_PREFIX_PATTERN.test(value);\n}\n\nfunction isImport(token) {\n  return IMPORT_PREFIX_PATTERN.test(token[1]);\n}\n\nfunction isLegacyFilter(property) {\n  var value;\n\n  if (property.name == 'filter' || property.name == '-ms-filter') {\n    value = property.value[0][1];\n\n    return value.indexOf('progid') > -1 ||\n      value.indexOf('alpha') === 0 ||\n      value.indexOf('chroma') === 0;\n  } else {\n    return false;\n  }\n}\n\nfunction noop() {}\n\nfunction optimizeBody(rule, properties, context) {\n  var options = context.options;\n  var valueOptimizers;\n  var property, name, type, value;\n  var propertyToken;\n  var propertyOptimizer;\n  var serializedRule = serializeRules(rule);\n  var _properties = wrapForOptimizing(properties);\n  var pluginValueOptimizers = context.options.plugins.level1Value;\n  var pluginPropertyOptimizers = context.options.plugins.level1Property;\n  var i, l;\n\n  propertyLoop:\n  for (i = 0, l = _properties.length; i < l; i++) {\n    var j, k, m, n;\n\n    property = _properties[i];\n    name = property.name;\n    propertyOptimizer = configuration[name] && configuration[name].propertyOptimizer || noop;\n    valueOptimizers = configuration[name] && configuration[name].valueOptimizers || [optimizers.whiteSpace];\n\n    if (!PROPERTY_NAME_PATTERN.test(name)) {\n      propertyToken = property.all[property.position];\n      context.warnings.push('Invalid property name \\'' + name + '\\' at ' + formatPosition(propertyToken[1][2][0]) + '. Ignoring.');\n      property.unused = true;\n      continue;\n    }\n\n    if (property.value.length === 0) {\n      propertyToken = property.all[property.position];\n      context.warnings.push('Empty property \\'' + name + '\\' at ' + formatPosition(propertyToken[1][2][0]) + '. Ignoring.');\n      property.unused = true;\n      continue;\n    }\n\n    if (property.hack && (\n        (property.hack[0] == Hack.ASTERISK || property.hack[0] == Hack.UNDERSCORE) && !options.compatibility.properties.iePrefixHack ||\n        property.hack[0] == Hack.BACKSLASH && !options.compatibility.properties.ieSuffixHack ||\n        property.hack[0] == Hack.BANG && !options.compatibility.properties.ieBangHack)) {\n      property.unused = true;\n      continue;\n    }\n\n    if (!options.compatibility.properties.ieFilters && isLegacyFilter(property)) {\n      property.unused = true;\n      continue;\n    }\n\n    if (property.block) {\n      optimizeBody(rule, property.value[0][1], context);\n      continue;\n    }\n\n    valuesLoop:\n    for (j = 0, m = property.value.length; j < m; j++) {\n      type = property.value[j][0];\n      value = property.value[j][1];\n\n      if (type == Token.PROPERTY_BLOCK) {\n        property.unused = true;\n        context.warnings.push('Invalid value token at ' + formatPosition(value[0][1][2][0]) + '. Ignoring.');\n        break;\n      }\n\n      if (startsAsUrl(value) && !context.validator.isUrl(value)) {\n        property.unused = true;\n        context.warnings.push('Broken URL \\'' + value + '\\' at ' + formatPosition(property.value[j][2][0]) + '. Ignoring.');\n        break;\n      }\n\n      for (k = 0, n = valueOptimizers.length; k < n; k++) {\n        value = valueOptimizers[k](name, value, options);\n      }\n\n      for (k = 0, n = pluginValueOptimizers.length; k < n; k++) {\n        value = pluginValueOptimizers[k](name, value, options);\n      }\n\n      property.value[j][1] = value;\n    }\n\n    propertyOptimizer(serializedRule, property, options);\n\n    for (j = 0, m = pluginPropertyOptimizers.length; j < m; j++) {\n      pluginPropertyOptimizers[j](serializedRule, property, options);\n    }\n  }\n\n  restoreFromOptimizing(_properties);\n  removeUnused(_properties);\n  removeComments(properties, options);\n}\n\nfunction removeComments(tokens, options) {\n  var token;\n  var i;\n\n  for (i = 0; i < tokens.length; i++) {\n    token = tokens[i];\n\n    if (token[0] != Token.COMMENT) {\n      continue;\n    }\n\n    optimizeComment(token, options);\n\n    if (token[1].length === 0) {\n      tokens.splice(i, 1);\n      i--;\n    }\n  }\n}\n\nfunction optimizeComment(token, options) {\n  if (token[1][2] == Marker.EXCLAMATION && (options.level[OptimizationLevel.One].specialComments == 'all' || options.commentsKept < options.level[OptimizationLevel.One].specialComments)) {\n    options.commentsKept++;\n    return;\n  }\n\n  token[1] = [];\n}\n\nfunction cleanupCharsets(tokens) {\n  var hasCharset = false;\n\n  for (var i = 0, l = tokens.length; i < l; i++) {\n    var token = tokens[i];\n\n    if (token[0] != Token.AT_RULE)\n      continue;\n\n    if (!CHARSET_REGEXP.test(token[1]))\n      continue;\n\n    if (hasCharset || token[1].indexOf(CHARSET_TOKEN) == -1) {\n      tokens.splice(i, 1);\n      i--;\n      l--;\n    } else {\n      hasCharset = true;\n      tokens.splice(i, 1);\n      tokens.unshift([Token.AT_RULE, token[1].replace(CHARSET_REGEXP, CHARSET_TOKEN)]);\n    }\n  }\n}\n\nfunction buildUnitRegexp(options) {\n  var units = ['px', 'em', 'ex', 'cm', 'mm', 'in', 'pt', 'pc', '%'];\n  var otherUnits = ['ch', 'rem', 'vh', 'vm', 'vmax', 'vmin', 'vw'];\n\n  otherUnits.forEach(function (unit) {\n    if (options.compatibility.units[unit]) {\n      units.push(unit);\n    }\n  });\n\n  return new RegExp('(^|\\\\s|\\\\(|,)0(?:' + units.join('|') + ')(\\\\W|$)', 'g');\n}\n\nfunction buildPrecisionOptions(roundingPrecision) {\n  var precisionOptions = {\n    matcher: null,\n    units: {},\n  };\n  var optimizable = [];\n  var unit;\n  var value;\n\n  for (unit in roundingPrecision) {\n    value = roundingPrecision[unit];\n\n    if (value != DEFAULT_ROUNDING_PRECISION) {\n      precisionOptions.units[unit] = {};\n      precisionOptions.units[unit].value = value;\n      precisionOptions.units[unit].multiplier = Math.pow(10, value);\n\n      optimizable.push(unit);\n    }\n  }\n\n  if (optimizable.length > 0) {\n    precisionOptions.enabled = true;\n    precisionOptions.decimalPointMatcher = new RegExp('(\\\\d)\\\\.($|' + optimizable.join('|') + ')($|\\\\W)', 'g');\n    precisionOptions.zeroMatcher = new RegExp('(\\\\d*)(\\\\.\\\\d+)(' + optimizable.join('|') + ')', 'g');\n  }\n\n  return precisionOptions;\n}\n\nfunction level1Optimize(tokens, context) {\n  var options = context.options;\n  var levelOptions = options.level[OptimizationLevel.One];\n  var ie7Hack = options.compatibility.selectors.ie7Hack;\n  var adjacentSpace = options.compatibility.selectors.adjacentSpace;\n  var spaceAfterClosingBrace = options.compatibility.properties.spaceAfterClosingBrace;\n  var format = options.format;\n  var mayHaveCharset = false;\n  var afterRules = false;\n\n  options.unitsRegexp = options.unitsRegexp || buildUnitRegexp(options);\n  options.precision = options.precision || buildPrecisionOptions(levelOptions.roundingPrecision);\n  options.commentsKept = options.commentsKept || 0;\n\n  for (var i = 0, l = tokens.length; i < l; i++) {\n    var token = tokens[i];\n\n    switch (token[0]) {\n      case Token.AT_RULE:\n        token[1] = isImport(token) && afterRules ? '' : token[1];\n        token[1] = levelOptions.tidyAtRules ? tidyAtRule(token[1]) : token[1];\n        mayHaveCharset = true;\n        break;\n      case Token.AT_RULE_BLOCK:\n        optimizeBody(token[1], token[2], context);\n        afterRules = true;\n        break;\n      case Token.NESTED_BLOCK:\n        token[1] = levelOptions.tidyBlockScopes ? tidyBlock(token[1], spaceAfterClosingBrace) : token[1];\n        level1Optimize(token[2], context);\n        afterRules = true;\n        break;\n      case Token.COMMENT:\n        optimizeComment(token, options);\n        break;\n      case Token.RULE:\n        token[1] = levelOptions.tidySelectors ? tidyRules(token[1], !ie7Hack, adjacentSpace, format, context.warnings) : token[1];\n        token[1] = token[1].length > 1 ? sortSelectors(token[1], levelOptions.selectorsSortingMethod) : token[1];\n        optimizeBody(token[1], token[2], context);\n        afterRules = true;\n        break;\n    }\n\n    if (token[0] == Token.COMMENT && token[1].length === 0 || levelOptions.removeEmpty && (token[1].length === 0 || (token[2] && token[2].length === 0))) {\n      tokens.splice(i, 1);\n      i--;\n      l--;\n    }\n  }\n\n  if (levelOptions.cleanupCharsets && mayHaveCharset) {\n    cleanupCharsets(tokens);\n  }\n\n  return tokens;\n}\n\nmodule.exports = level1Optimize;\n"]},"metadata":{},"sourceType":"script"}