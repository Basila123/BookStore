{"ast":null,"code":"'use strict';\n\nconst {\n  selectAll,\n  selectOne,\n  is\n} = require('css-select');\n\nconst svgoCssSelectAdapter = require('./css-select-adapter');\n\nconst CSSClassList = require('./css-class-list');\n\nconst CSSStyleDeclaration = require('./css-style-declaration');\n/**\n * @type {(name: string) => { prefix: string, local: string }}\n */\n\n\nconst parseName = name => {\n  if (name == null) {\n    return {\n      prefix: '',\n      local: ''\n    };\n  }\n\n  if (name === 'xmlns') {\n    return {\n      prefix: 'xmlns',\n      local: ''\n    };\n  }\n\n  const chunks = name.split(':');\n\n  if (chunks.length === 1) {\n    return {\n      prefix: '',\n      local: chunks[0]\n    };\n  }\n\n  return {\n    prefix: chunks[0],\n    local: chunks[1]\n  };\n};\n\nvar cssSelectOpts = {\n  xmlMode: true,\n  adapter: svgoCssSelectAdapter\n};\nconst attrsHandler = {\n  get: (attributes, name) => {\n    // eslint-disable-next-line no-prototype-builtins\n    if (attributes.hasOwnProperty(name)) {\n      return {\n        name,\n\n        get value() {\n          return attributes[name];\n        },\n\n        set value(value) {\n          attributes[name] = value;\n        }\n\n      };\n    }\n  },\n  set: (attributes, name, attr) => {\n    attributes[name] = attr.value;\n    return true;\n  }\n};\n\nvar JSAPI = function (data, parentNode) {\n  Object.assign(this, data);\n\n  if (this.type === 'element') {\n    if (this.attributes == null) {\n      this.attributes = {};\n    }\n\n    if (this.children == null) {\n      this.children = [];\n    }\n\n    Object.defineProperty(this, 'class', {\n      writable: true,\n      configurable: true,\n      value: new CSSClassList(this)\n    });\n    Object.defineProperty(this, 'style', {\n      writable: true,\n      configurable: true,\n      value: new CSSStyleDeclaration(this)\n    });\n    Object.defineProperty(this, 'parentNode', {\n      writable: true,\n      value: parentNode\n    }); // temporary attrs polyfill\n    // TODO remove after migration\n\n    const element = this;\n    Object.defineProperty(this, 'attrs', {\n      configurable: true,\n\n      get() {\n        return new Proxy(element.attributes, attrsHandler);\n      },\n\n      set(value) {\n        const newAttributes = {};\n\n        for (const attr of Object.values(value)) {\n          newAttributes[attr.name] = attr.value;\n        }\n\n        element.attributes = newAttributes;\n      }\n\n    });\n  }\n};\n\nmodule.exports = JSAPI;\n/**\n * Perform a deep clone of this node.\n *\n * @return {Object} element\n */\n\nJSAPI.prototype.clone = function () {\n  const {\n    children,\n    ...nodeData\n  } = this; // Deep-clone node data.\n\n  const clonedNode = new JSAPI(JSON.parse(JSON.stringify(nodeData)), null);\n\n  if (children) {\n    clonedNode.children = children.map(child => {\n      const clonedChild = child.clone();\n      clonedChild.parentNode = clonedNode;\n      return clonedChild;\n    });\n  }\n\n  return clonedNode;\n};\n/**\n * Determine if item is an element\n * (any, with a specific name or in a names array).\n *\n * @param {String|Array} [param] element name or names arrays\n * @return {Boolean}\n */\n\n\nJSAPI.prototype.isElem = function (param) {\n  if (this.type !== 'element') {\n    return false;\n  }\n\n  if (param == null) {\n    return true;\n  }\n\n  if (Array.isArray(param)) {\n    return param.includes(this.name);\n  }\n\n  return this.name === param;\n};\n/**\n * Renames an element\n *\n * @param {String} name new element name\n * @return {Object} element\n */\n\n\nJSAPI.prototype.renameElem = function (name) {\n  if (name && typeof name === 'string') this.name = name;\n  return this;\n};\n/**\n * Determine if element is empty.\n *\n * @return {Boolean}\n */\n\n\nJSAPI.prototype.isEmpty = function () {\n  return !this.children || !this.children.length;\n};\n/**\n * Find the closest ancestor of the current element.\n * @param elemName\n *\n * @return {?Object}\n */\n\n\nJSAPI.prototype.closestElem = function (elemName) {\n  var elem = this;\n\n  while ((elem = elem.parentNode) && !elem.isElem(elemName));\n\n  return elem;\n};\n/**\n * Changes children by removing elements and/or adding new elements.\n *\n * @param {Number} start Index at which to start changing the children.\n * @param {Number} n Number of elements to remove.\n * @param {Array|Object} [insertion] Elements to add to the children.\n * @return {Array} Removed elements.\n */\n\n\nJSAPI.prototype.spliceContent = function (start, n, insertion) {\n  if (arguments.length < 2) return [];\n  if (!Array.isArray(insertion)) insertion = Array.apply(null, arguments).slice(2);\n  insertion.forEach(function (inner) {\n    inner.parentNode = this;\n  }, this);\n  return this.children.splice.apply(this.children, [start, n].concat(insertion));\n};\n/**\n * Determine if element has an attribute\n * (any, or by name or by name + value).\n *\n * @param {String} [name] attribute name\n * @param {String} [val] attribute value (will be toString()'ed)\n * @return {Boolean}\n */\n\n\nJSAPI.prototype.hasAttr = function (name, val) {\n  if (this.type !== 'element') {\n    return false;\n  }\n\n  if (Object.keys(this.attributes).length === 0) {\n    return false;\n  }\n\n  if (name == null) {\n    return true;\n  } // eslint-disable-next-line no-prototype-builtins\n\n\n  if (this.attributes.hasOwnProperty(name) === false) {\n    return false;\n  }\n\n  if (val !== undefined) {\n    return this.attributes[name] === val.toString();\n  }\n\n  return true;\n};\n/**\n * Determine if element has an attribute by local name\n * (any, or by name or by name + value).\n *\n * @param {String} [localName] local attribute name\n * @param {Number|String|RegExp|Function} [val] attribute value (will be toString()'ed or executed, otherwise ignored)\n * @return {Boolean}\n */\n\n\nJSAPI.prototype.hasAttrLocal = function (localName, val) {\n  if (!this.attrs || !Object.keys(this.attrs).length) return false;\n  if (!arguments.length) return !!this.attrs;\n  var callback;\n\n  switch (val != null && val.constructor && val.constructor.name) {\n    case 'Number': // same as String\n\n    case 'String':\n      callback = stringValueTest;\n      break;\n\n    case 'RegExp':\n      callback = regexpValueTest;\n      break;\n\n    case 'Function':\n      callback = funcValueTest;\n      break;\n\n    default:\n      callback = nameTest;\n  }\n\n  return this.someAttr(callback);\n\n  function nameTest(attr) {\n    const {\n      local\n    } = parseName(attr.name);\n    return local === localName;\n  }\n\n  function stringValueTest(attr) {\n    const {\n      local\n    } = parseName(attr.name);\n    return local === localName && val == attr.value;\n  }\n\n  function regexpValueTest(attr) {\n    const {\n      local\n    } = parseName(attr.name);\n    return local === localName && val.test(attr.value);\n  }\n\n  function funcValueTest(attr) {\n    const {\n      local\n    } = parseName(attr.name);\n    return local === localName && val(attr.value);\n  }\n};\n/**\n * Get a specific attribute from an element\n * (by name or name + value).\n *\n * @param {String} name attribute name\n * @param {String} [val] attribute value (will be toString()'ed)\n * @return {Object|Undefined}\n */\n\n\nJSAPI.prototype.attr = function (name, val) {\n  if (this.hasAttr(name, val)) {\n    return this.attrs[name];\n  }\n};\n/**\n * Get computed attribute value from an element\n *\n * @param {String} name attribute name\n * @return {Object|Undefined}\n */\n\n\nJSAPI.prototype.computedAttr = function (name, val) {\n  if (!arguments.length) return;\n\n  for (var elem = this; elem && (!elem.hasAttr(name) || !elem.attributes[name]); elem = elem.parentNode);\n\n  if (val != null) {\n    return elem ? elem.hasAttr(name, val) : false;\n  } else if (elem && elem.hasAttr(name)) {\n    return elem.attributes[name];\n  }\n};\n/**\n * Remove a specific attribute.\n *\n * @param {String|Array} name attribute name\n * @param {String} [val] attribute value\n * @return {Boolean}\n */\n\n\nJSAPI.prototype.removeAttr = function (name, val) {\n  if (this.type !== 'element') {\n    return false;\n  }\n\n  if (arguments.length === 0) {\n    return false;\n  }\n\n  if (Array.isArray(name)) {\n    for (const nameItem of name) {\n      this.removeAttr(nameItem, val);\n    }\n\n    return false;\n  }\n\n  if (this.hasAttr(name, val) === false) {\n    return false;\n  }\n\n  delete this.attributes[name];\n  return true;\n};\n/**\n * Add attribute.\n *\n * @param {Object} [attr={}] attribute object\n * @return {Object|Boolean} created attribute or false if no attr was passed in\n */\n\n\nJSAPI.prototype.addAttr = function (attr) {\n  attr = attr || {};\n  if (attr.name === undefined) return false;\n  this.attributes[attr.name] = attr.value;\n\n  if (attr.name === 'class') {\n    // newly added class attribute\n    this.class.addClassValueHandler();\n  }\n\n  if (attr.name === 'style') {\n    // newly added style attribute\n    this.style.addStyleValueHandler();\n  }\n\n  return this.attrs[attr.name];\n};\n/**\n * Iterates over all attributes.\n *\n * @param {Function} callback callback\n * @param {Object} [context] callback context\n * @return {Boolean} false if there are no any attributes\n */\n\n\nJSAPI.prototype.eachAttr = function (callback, context) {\n  if (this.type !== 'element') {\n    return false;\n  }\n\n  if (callback == null) {\n    return false;\n  }\n\n  for (const attr of Object.values(this.attrs)) {\n    callback.call(context, attr);\n  }\n\n  return true;\n};\n/**\n * Tests whether some attribute passes the test.\n *\n * @param {Function} callback callback\n * @param {Object} [context] callback context\n * @return {Boolean} false if there are no any attributes\n */\n\n\nJSAPI.prototype.someAttr = function (callback, context) {\n  if (this.type !== 'element') {\n    return false;\n  }\n\n  for (const attr of Object.values(this.attrs)) {\n    if (callback.call(context, attr)) return true;\n  }\n\n  return false;\n};\n/**\n * Evaluate a string of CSS selectors against the element and returns matched elements.\n *\n * @param {String} selectors CSS selector(s) string\n * @return {Array} null if no elements matched\n */\n\n\nJSAPI.prototype.querySelectorAll = function (selectors) {\n  var matchedEls = selectAll(selectors, this, cssSelectOpts);\n  return matchedEls.length > 0 ? matchedEls : null;\n};\n/**\n * Evaluate a string of CSS selectors against the element and returns only the first matched element.\n *\n * @param {String} selectors CSS selector(s) string\n * @return {Array} null if no element matched\n */\n\n\nJSAPI.prototype.querySelector = function (selectors) {\n  return selectOne(selectors, this, cssSelectOpts);\n};\n/**\n * Test if a selector matches a given element.\n *\n * @param {String} selector CSS selector string\n * @return {Boolean} true if element would be selected by selector string, false if it does not\n */\n\n\nJSAPI.prototype.matches = function (selector) {\n  return is(this, selector, cssSelectOpts);\n};","map":{"version":3,"sources":["/home/hp/Js/React_practise/BookStore/books/node_modules/postcss-svgo/node_modules/svgo/lib/svgo/jsAPI.js"],"names":["selectAll","selectOne","is","require","svgoCssSelectAdapter","CSSClassList","CSSStyleDeclaration","parseName","name","prefix","local","chunks","split","length","cssSelectOpts","xmlMode","adapter","attrsHandler","get","attributes","hasOwnProperty","value","set","attr","JSAPI","data","parentNode","Object","assign","type","children","defineProperty","writable","configurable","element","Proxy","newAttributes","values","module","exports","prototype","clone","nodeData","clonedNode","JSON","parse","stringify","map","child","clonedChild","isElem","param","Array","isArray","includes","renameElem","isEmpty","closestElem","elemName","elem","spliceContent","start","n","insertion","arguments","apply","slice","forEach","inner","splice","concat","hasAttr","val","keys","undefined","toString","hasAttrLocal","localName","attrs","callback","constructor","stringValueTest","regexpValueTest","funcValueTest","nameTest","someAttr","test","computedAttr","removeAttr","nameItem","addAttr","class","addClassValueHandler","style","addStyleValueHandler","eachAttr","context","call","querySelectorAll","selectors","matchedEls","querySelector","matches","selector"],"mappings":"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","sourcesContent":["'use strict';\n\nconst { selectAll, selectOne, is } = require('css-select');\nconst svgoCssSelectAdapter = require('./css-select-adapter');\nconst CSSClassList = require('./css-class-list');\nconst CSSStyleDeclaration = require('./css-style-declaration');\n\n/**\n * @type {(name: string) => { prefix: string, local: string }}\n */\nconst parseName = (name) => {\n  if (name == null) {\n    return {\n      prefix: '',\n      local: '',\n    };\n  }\n  if (name === 'xmlns') {\n    return {\n      prefix: 'xmlns',\n      local: '',\n    };\n  }\n  const chunks = name.split(':');\n  if (chunks.length === 1) {\n    return {\n      prefix: '',\n      local: chunks[0],\n    };\n  }\n  return {\n    prefix: chunks[0],\n    local: chunks[1],\n  };\n};\n\nvar cssSelectOpts = {\n  xmlMode: true,\n  adapter: svgoCssSelectAdapter,\n};\n\nconst attrsHandler = {\n  get: (attributes, name) => {\n    // eslint-disable-next-line no-prototype-builtins\n    if (attributes.hasOwnProperty(name)) {\n      return {\n        name,\n        get value() {\n          return attributes[name];\n        },\n        set value(value) {\n          attributes[name] = value;\n        },\n      };\n    }\n  },\n  set: (attributes, name, attr) => {\n    attributes[name] = attr.value;\n    return true;\n  },\n};\n\nvar JSAPI = function (data, parentNode) {\n  Object.assign(this, data);\n  if (this.type === 'element') {\n    if (this.attributes == null) {\n      this.attributes = {};\n    }\n    if (this.children == null) {\n      this.children = [];\n    }\n    Object.defineProperty(this, 'class', {\n      writable: true,\n      configurable: true,\n      value: new CSSClassList(this),\n    });\n    Object.defineProperty(this, 'style', {\n      writable: true,\n      configurable: true,\n      value: new CSSStyleDeclaration(this),\n    });\n    Object.defineProperty(this, 'parentNode', {\n      writable: true,\n      value: parentNode,\n    });\n\n    // temporary attrs polyfill\n    // TODO remove after migration\n    const element = this;\n    Object.defineProperty(this, 'attrs', {\n      configurable: true,\n      get() {\n        return new Proxy(element.attributes, attrsHandler);\n      },\n      set(value) {\n        const newAttributes = {};\n        for (const attr of Object.values(value)) {\n          newAttributes[attr.name] = attr.value;\n        }\n        element.attributes = newAttributes;\n      },\n    });\n  }\n};\nmodule.exports = JSAPI;\n\n/**\n * Perform a deep clone of this node.\n *\n * @return {Object} element\n */\nJSAPI.prototype.clone = function () {\n  const { children, ...nodeData } = this;\n  // Deep-clone node data.\n  const clonedNode = new JSAPI(JSON.parse(JSON.stringify(nodeData)), null);\n  if (children) {\n    clonedNode.children = children.map((child) => {\n      const clonedChild = child.clone();\n      clonedChild.parentNode = clonedNode;\n      return clonedChild;\n    });\n  }\n  return clonedNode;\n};\n\n/**\n * Determine if item is an element\n * (any, with a specific name or in a names array).\n *\n * @param {String|Array} [param] element name or names arrays\n * @return {Boolean}\n */\nJSAPI.prototype.isElem = function (param) {\n  if (this.type !== 'element') {\n    return false;\n  }\n  if (param == null) {\n    return true;\n  }\n  if (Array.isArray(param)) {\n    return param.includes(this.name);\n  }\n  return this.name === param;\n};\n\n/**\n * Renames an element\n *\n * @param {String} name new element name\n * @return {Object} element\n */\nJSAPI.prototype.renameElem = function (name) {\n  if (name && typeof name === 'string') this.name = name;\n\n  return this;\n};\n\n/**\n * Determine if element is empty.\n *\n * @return {Boolean}\n */\nJSAPI.prototype.isEmpty = function () {\n  return !this.children || !this.children.length;\n};\n\n/**\n * Find the closest ancestor of the current element.\n * @param elemName\n *\n * @return {?Object}\n */\nJSAPI.prototype.closestElem = function (elemName) {\n  var elem = this;\n\n  while ((elem = elem.parentNode) && !elem.isElem(elemName));\n\n  return elem;\n};\n\n/**\n * Changes children by removing elements and/or adding new elements.\n *\n * @param {Number} start Index at which to start changing the children.\n * @param {Number} n Number of elements to remove.\n * @param {Array|Object} [insertion] Elements to add to the children.\n * @return {Array} Removed elements.\n */\nJSAPI.prototype.spliceContent = function (start, n, insertion) {\n  if (arguments.length < 2) return [];\n\n  if (!Array.isArray(insertion))\n    insertion = Array.apply(null, arguments).slice(2);\n\n  insertion.forEach(function (inner) {\n    inner.parentNode = this;\n  }, this);\n\n  return this.children.splice.apply(\n    this.children,\n    [start, n].concat(insertion)\n  );\n};\n\n/**\n * Determine if element has an attribute\n * (any, or by name or by name + value).\n *\n * @param {String} [name] attribute name\n * @param {String} [val] attribute value (will be toString()'ed)\n * @return {Boolean}\n */\nJSAPI.prototype.hasAttr = function (name, val) {\n  if (this.type !== 'element') {\n    return false;\n  }\n  if (Object.keys(this.attributes).length === 0) {\n    return false;\n  }\n  if (name == null) {\n    return true;\n  }\n  // eslint-disable-next-line no-prototype-builtins\n  if (this.attributes.hasOwnProperty(name) === false) {\n    return false;\n  }\n  if (val !== undefined) {\n    return this.attributes[name] === val.toString();\n  }\n  return true;\n};\n\n/**\n * Determine if element has an attribute by local name\n * (any, or by name or by name + value).\n *\n * @param {String} [localName] local attribute name\n * @param {Number|String|RegExp|Function} [val] attribute value (will be toString()'ed or executed, otherwise ignored)\n * @return {Boolean}\n */\nJSAPI.prototype.hasAttrLocal = function (localName, val) {\n  if (!this.attrs || !Object.keys(this.attrs).length) return false;\n\n  if (!arguments.length) return !!this.attrs;\n\n  var callback;\n\n  switch (val != null && val.constructor && val.constructor.name) {\n    case 'Number': // same as String\n    case 'String':\n      callback = stringValueTest;\n      break;\n    case 'RegExp':\n      callback = regexpValueTest;\n      break;\n    case 'Function':\n      callback = funcValueTest;\n      break;\n    default:\n      callback = nameTest;\n  }\n  return this.someAttr(callback);\n\n  function nameTest(attr) {\n    const { local } = parseName(attr.name);\n    return local === localName;\n  }\n\n  function stringValueTest(attr) {\n    const { local } = parseName(attr.name);\n    return local === localName && val == attr.value;\n  }\n\n  function regexpValueTest(attr) {\n    const { local } = parseName(attr.name);\n    return local === localName && val.test(attr.value);\n  }\n\n  function funcValueTest(attr) {\n    const { local } = parseName(attr.name);\n    return local === localName && val(attr.value);\n  }\n};\n\n/**\n * Get a specific attribute from an element\n * (by name or name + value).\n *\n * @param {String} name attribute name\n * @param {String} [val] attribute value (will be toString()'ed)\n * @return {Object|Undefined}\n */\nJSAPI.prototype.attr = function (name, val) {\n  if (this.hasAttr(name, val)) {\n    return this.attrs[name];\n  }\n};\n\n/**\n * Get computed attribute value from an element\n *\n * @param {String} name attribute name\n * @return {Object|Undefined}\n */\nJSAPI.prototype.computedAttr = function (name, val) {\n  if (!arguments.length) return;\n\n  for (\n    var elem = this;\n    elem && (!elem.hasAttr(name) || !elem.attributes[name]);\n    elem = elem.parentNode\n  );\n\n  if (val != null) {\n    return elem ? elem.hasAttr(name, val) : false;\n  } else if (elem && elem.hasAttr(name)) {\n    return elem.attributes[name];\n  }\n};\n\n/**\n * Remove a specific attribute.\n *\n * @param {String|Array} name attribute name\n * @param {String} [val] attribute value\n * @return {Boolean}\n */\nJSAPI.prototype.removeAttr = function (name, val) {\n  if (this.type !== 'element') {\n    return false;\n  }\n  if (arguments.length === 0) {\n    return false;\n  }\n  if (Array.isArray(name)) {\n    for (const nameItem of name) {\n      this.removeAttr(nameItem, val);\n    }\n    return false;\n  }\n  if (this.hasAttr(name, val) === false) {\n    return false;\n  }\n  delete this.attributes[name];\n  return true;\n};\n\n/**\n * Add attribute.\n *\n * @param {Object} [attr={}] attribute object\n * @return {Object|Boolean} created attribute or false if no attr was passed in\n */\nJSAPI.prototype.addAttr = function (attr) {\n  attr = attr || {};\n\n  if (attr.name === undefined) return false;\n\n  this.attributes[attr.name] = attr.value;\n\n  if (attr.name === 'class') {\n    // newly added class attribute\n    this.class.addClassValueHandler();\n  }\n\n  if (attr.name === 'style') {\n    // newly added style attribute\n    this.style.addStyleValueHandler();\n  }\n\n  return this.attrs[attr.name];\n};\n\n/**\n * Iterates over all attributes.\n *\n * @param {Function} callback callback\n * @param {Object} [context] callback context\n * @return {Boolean} false if there are no any attributes\n */\nJSAPI.prototype.eachAttr = function (callback, context) {\n  if (this.type !== 'element') {\n    return false;\n  }\n  if (callback == null) {\n    return false;\n  }\n  for (const attr of Object.values(this.attrs)) {\n    callback.call(context, attr);\n  }\n  return true;\n};\n\n/**\n * Tests whether some attribute passes the test.\n *\n * @param {Function} callback callback\n * @param {Object} [context] callback context\n * @return {Boolean} false if there are no any attributes\n */\nJSAPI.prototype.someAttr = function (callback, context) {\n  if (this.type !== 'element') {\n    return false;\n  }\n\n  for (const attr of Object.values(this.attrs)) {\n    if (callback.call(context, attr)) return true;\n  }\n\n  return false;\n};\n\n/**\n * Evaluate a string of CSS selectors against the element and returns matched elements.\n *\n * @param {String} selectors CSS selector(s) string\n * @return {Array} null if no elements matched\n */\nJSAPI.prototype.querySelectorAll = function (selectors) {\n  var matchedEls = selectAll(selectors, this, cssSelectOpts);\n\n  return matchedEls.length > 0 ? matchedEls : null;\n};\n\n/**\n * Evaluate a string of CSS selectors against the element and returns only the first matched element.\n *\n * @param {String} selectors CSS selector(s) string\n * @return {Array} null if no element matched\n */\nJSAPI.prototype.querySelector = function (selectors) {\n  return selectOne(selectors, this, cssSelectOpts);\n};\n\n/**\n * Test if a selector matches a given element.\n *\n * @param {String} selector CSS selector string\n * @return {Boolean} true if element would be selected by selector string, false if it does not\n */\nJSAPI.prototype.matches = function (selector) {\n  return is(this, selector, cssSelectOpts);\n};\n"]},"metadata":{},"sourceType":"script"}